<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Сниппет TSVShop</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<style type="text/css" media="screen">
* { margin: 0; padding: 0;}
html {  /*BACKGROUND: url(gridbg1.gif) transparent*/; background: #fff; font: 12px/18px Tahoma, Verdana, Arial, Helvetica, sans-serif; padding: 0px 36px; }

body, td, th, h3, h6 {
	color: #330000; line-height:18px;
}

h1, h2, h3, h4 { display:block; padding-bottom: 5px; font-family:  Verdana, Arial, Helvetica, sans-serif;  font-weight: normal; margin-bottom:15px; border-bottom:1px solid #ccc}
h1 { font-size: 200%; margin-top: 27px;font-weight: bold;margin-bottom:18px;color: #6F9400}
h2 { font-size: 170%; margin-top: 18px;}
h3 { font-size: 140%; margin-top: 18px;}
h4 { font-size: 110%; font-weight: bold; margin-top: 18px;}

p, ul, ol,  pl { margin-bottom: 18px; }
ul, ol  {margin-left:36px;}
a {	color: #001767;}

pre, code { font: 1.2em/1.8 "Courier New", Courier, monospace; border: 1px dashed #aaa; padding: 1em; background: #C6CABA; }
code { display:block; padding: .2em .5em; }
blockquote { margin-left: 10em; padding-bottom:5px; padding-left: 1em; border-left: 2px solid #ccc; background: #f9f9f9;}
table { border-collapse: collapse; width: 100%; }
table th, table td { border: 1px solid #ccc; padding: 3px 4px; }
table th { background: #f4f4f4; }
table td {  }
table td.head {font-weight:bold; text-align:center; background:#f4f4f4;}
</style>
</head>

<body>
<h1>Сниппет/Модуль TSVshop</h1>
<p>Сниппет, модуль, плагин для создания корзины заказов на сайте.  Разработка - <b>Тельный Сергей</b> (<a href="mailto:privat_tel@mail.ru">privat_tel@mail.ru</a>), спасибо <b>Матюхину Максиму</b> (<a href="mailto:matuhinmax@mail.ru">matuhinmax@mail.ru</a>), <b>Александр Поляков</b> (<a href="mailto:lecosson@gmail.com">lecosson@gmail.com</a>). По всем замечаниям и вопросам пишите на <a href="mailto:privat_tel@mail.ru">privat_tel@mail.ru</a> или в аську 207598689.</p>
<p>Официальный сайт: <a href="http://tsvshop.tsv.org.ua">http://tsvshop.tsv.org.ua</a></p>

<h2>Важные изменения</h2>
<b>Версия V4.9 rc</b><br>
<ul>
<li>Добавлена возможность продавать файлы. Для этого были внесены соответвующие изменения в ядро модуля, а также разработан плагин <b>TSVshop_downloads</b></li>
<li>В сниппете TSVshop для режима инфоблока <i>&act=`info`</i> добавлен параметр <i>hideon</i>, который принимает ИД документов, через запятую. Это позволяет скрывать инфоблок на соответствующих страницах. </li>
<li>Исправлена ошибка, когда неправильно зашифровывались/расшифровывались данные пользователя.</li>
<li>В аддоне "Заказы" добавлена возможность распечатать выбранный заказ.</li>
<li>Исправлена ошибка в документации: в шаблоне карточки товара для отдельной страницы 2 раза встречался плейсхолдер [+tsvoptions+]. Нужно только один, а
второй [+tsvservices+]</li>
<li>Экстендеры для Ditto: shop и sortprice объединены в один. Соответсвенно, екстендер sortprice не нужно вставлять в вызов Ditto. Достаточно только shop</li>
<li>Добавлено новое событие: <li>TSVshopOnOrderStatusUpdate</li>, которое срабатывает при
обновлении статуса заказа. Принимает массив с данными: <i>idorder</i> - номер заказа,
<i>newstatus</i> - новый статус.</li>
<li>В соответствии с вышеперечисленным, обновлена документация.</li>
</ul>

<h2>Важные изменения</h2>
<b>Версия V4.7 rc1</b><br>
<ul>
<li>В комплект TSVshop добавлен сниппет TSVoffice для создания личного кабинета пользователя, позволяющего ему регистрироваться, авторизовываться, редактировать свой профиль и просматривать свои заказы. Документация к сниппету находится по адресу: /assets/snippets/tsvoffice/readme.docx</li>
<li>В комплект TSVshop добавлен файл-extender для сниппета Ditto, позволяющий сортировать товары магазина по цене-формуле и параметрам товара.</li>
<li>Добавлено действие для сниппета &act=`itemcard`, предназначенное для вставки в карточку товара. Теперь упростилась структура вывода информации в карточке товара. Подробнее читайте выше: раздел <b>Автоматическая установка</b>, пункт 8.4 или <b>Ручная установка</b>, пункт 30.</li>
<li>Добавлено событие <i>TSVshopOnViewItemCard</i>, срабатывающее при просмотре карточки товара. Его можно обрабатывать плагином, например, для подсчета просмотров товара.</li>
<li>Изменены названия плейсхолдеров в чанке товара <i>product</i>: options на tsvoptions, total_price на tsvprice, button_atributes на tsvbattr</li>
Изменен алгоритм шифрования личной информации пользователя. Теперь используется алгоритм XXTEA.
<li>Больше нету понятия краткая и полная версия инфоблока. Есть только версия для полной и пустой корзины.</li>
<li>Исправлены многие ошибки, в том числе проблемы при установке модуля, неправильного формирования адреса товара в корзине</li>
</ul>

<h2>Автоматическая установка</h2>
<p>ВАЖНО! Этот вариант установки можно делать ТОЛЬКО на уже установленный MODx. Поэтому прежде чем вы последуете нижеприведенным шагам, установите сначала MODx обычным способом. </p><p>После этого делаем следующее: </p>
<ol>
<li>Скачайте архив модуля и распакуйте его. После распаковки вы увидите две папки: <i>assets</i> и <i>install</i>. </li>
<li>Разместите эти папки в корень вашего сайта поверх уже существующих папок.  </li>
<li>На файлы <b>/assets/snippets/tsvshop/js/config.js</b> и <b>/assets/snippets/tsvshop/include/config.inc.php</b> нужно выставить права на запись (обычно 666)</li>
<li>Перейдите в браузере по пути <i>http://ваш.домен/install</i>. Начнется процесс установки, напоминающий стандартную установку MODx. Пройдите его полностью до конца. На странице выбора устанавливаемых компонентов отметьте галочками все, что вам нужно (а нужно все). После установки будут созданы все необходимые компоненты. </li>
<li>В случае, если вы устанавливаете модуль на "пустой" MODx (без контента), крайне желательно, чтобы вы установили ДЕМО-КОНТЕНТ, т.к. при этом создадутся все необходимые для работы модуля страницы (<span style="color:red">на работающем сайте ДЕМО-КОНТЕНТ ставить нельзя, т.к. он может удалить существующие страницы. В таком случае для создания нужных страниц смотрите пункт 8</span>). Далее вы сможете уже подкорректировать или совсем сменить дизайн и т.д. </li>
<li>Зайдите в админку и перейдите на вкладку МОДУЛИ -&gt; TSVshop. Там в разделе <i>Аддоны</i> установите нужные вам аддоны. </li>
<li>В разделе <i>Конфигурация</i> выполните все нужные настройки. </li>
<li>В случае, если вы устанавливаете модуль на РАБОТАЮЩИЙ сайт (не устанавливали ДЕМО-КОНТЕНТ), создайте три документа, где будут <b>Корзина</b>, <b>Оформление покупки</b> и <b>Завершение покупки</b> (сделайте скрытой); Далее:
<ol><li>Для <b>Корзины</b> вызов сниппета такой:<br /> <code>[!TSVshop? &act=`basket` &checkid=``!]</code> – где <i>checkid</i> – ИД страницы оформления покупки;</li>
<li>Для <b>Оформления покупки</b> вызов такой:<br /> <code>[!TSVshop? &act=`checkout` &backid=``!]</code> – где <i>backid</i> – ИД страницы, куда переход после успешной покупки;</li>
<li>Для <b>Завершения покупки</b> такой:<br /> <code>[!TSVshop? &act=`finish`!]</code></li>
<li>Если вам нужно вставить кнопку добавления товара в корзину на отдельной странице, без использования Ditto, то воспользуйтесь таким кодом:
<code>
[!TSVshop? &act=`itemcard`!]
&lt;form action="" method="post" name="Tovar[*id*]" id="Tovar[*id*]" &gt;
[+tsvoptions+]
  Цена: [+tsvprice+] руб.
  &lt;p&gt;&lt;input type="text" name="qty" value="1" [+tsvbattr+] /&gt;&lt;/p&gt;
   &lt;a href="javascript: void(0);" onclick="AddToCart('[*id*]');return false"&gt;В корзину&lt;/a&gt;
[+tsvservices+]
&lt;/form&gt;
</code>
  Обратите внимание, что обязательно наличие вызова сниппета [!TSVshop? &act=`itemcard`!], поскольку с его помощью идет обработка плейсхолдеров [+tsvoptions+], [+tsvprice+], [+tsvbattr+] и [+tsvservices+] (это системные плейсхолдеры, вместо которых выводится служебная информация). Также при вызове [!TSVshop? &act=`itemcard`!] срабатывает событие <i>TSVshopOnViewItemCard</i>, которое можно повесить на плагин для обработки карточки товара или для подсчета просмотров товара.
</li>
</ol>

</li>
</ol>

<h2>Ручная установка</h2>
<p>Данный вид установки довольно трудоемкий, поскольку нужно проделать много рутинной работы. Поэтому крайне желательно воспользоваться автоматической установкой. Но если вы все же решили установить TSVshop вручную, то сделайте следующее:</p>
<ol>
<li>Распакуйте архив и полученную папку assets закачайте в корневую папку MODx (где находится папка assets);</li>
<li>Откройте папку /assets/snippets/tsvshop/install, внутри которой вы увидите файлы установки.</li>
<li>Создайте модуль <i>TSVshop</i>, воспользовавшись файлом <b>TSVshop.module.tpl</b> из папки install;</li>
<li>Создайте сниппет <i>TSVshop</i>, воспользовавшись файлом <b>TSVshop.snippet.tpl</b> из папки install;</li>
<li>Создайте сниппет <i>TSVshop_options</i>, воспользовавшись файлом <b>TSVshop_options.snippet.tpl</b> из папки install;</li>
<li>Создайте чанк <i>product</i>, воспользовавшись файлом <b>product.chunk.tpl</b> (с помощью этого чанка и Дитто будет выводиться список товаров) из папки install;</li>
<li>Создайте чанк <i>Shop_Cart</i>, воспользовавшись файлом <b>Shop_Cart.chunk.tpl</b> (шаблон корзины заказов) из папки install;</li>
<li>Создайте чанк <i>Shop_Cart_Empty</i>, воспользовавшись файлом <b>Shop_Cart_Empty.chunk.tpl</b> (шаблон пустой корзины заказов) из папки install;</li>
<li>Создайте чанк <i>Shop_Checkout</i>, воспользовавшись файлом <b>Shop_Checkout.chunk.tpl</b> (шаблон корзины при оформлении заказов) из папки install;</li>
<li>Создайте чанк <i>Shop_Infoblock</i>, воспользовавшись файлом <b>Shop_Infoblock.chunk.tpl</b> (шаблон инфоблока) из папки install;</li>
<li>Создайте чанк <i>Shop_FinishText</i>, воспользовавшись файлом <b>Shop_FinishText.chunk.tpl</b> (выводит сообщение об успешной покупке) из папки install;</li>
<li>Создайте чанк <i>Shop_UserForm</i>, воспользовавшись файлом <b>Shop_UserForm.chunk.tpl</b> (выводит форму для данных пользователя) из папки install;</li>
<li>Создайте чанк <i>Shop_mail_admin</i>, воспользовавшись файлом <b>Shop_mail_admin.chunk.tpl</b> (задает вид письма админу для подтверждения заказа) из папки install;</li>
<li>Создайте чанк <i>Shop_mail_klient</i>, воспользовавшись файлом <b>Shop_mail_klient.chunk.tpl</b> (задает вид письма клиенту для подтверждения заказа) из папки install;</li>
<li>Создайте чанк <i>Shop_UpdateOrder</i>, воспользовавшись файлом <b>Shop_UpdateOrder.chunk.tpl</b> (задает вид письма обновления статуса заказа) из папки install;</li>

<li>Создайте плагин <i>TSVсlearCache</i>, воспользовавшись файлом <b>TSVсlearCache.plugin.tpl</b> из папки install; присвойте события <b>OnCacheUpdate</b>, <b>OnManagerPageInit</b></li>
<li>Создайте плагин <i>TSVshopNotifier</i>, воспользовавшись файлом <b>TSVshopNotifier.plugin.tpl</b> из папки install; присвойте события <b>OnManagerWelcomePrerender</b></li>
<li>Создайте плагин <i>Hints</i>, воспользовавшись файлом <b>Hints.plugin.tpl</b> из папки install; присвойте события <b>OnChunkFormRender</b>, <b>OnTempFormRender</b>, конфигурация <i>&lang=hints language;string;ru</i></li>

<li>Создайте TV-параметр <i>price</i>, в котором будет задаваться цена товара. Присвойте этот параметр шаблону страницы, которая является карточкой товара;</li>
<li>Создайте TV-параметр <i>tsvshop_param</i>, в котором будет задаваться дополнительные свойства товара. Присвойте этот параметр шаблону страницы, которая является карточкой товара;</li>
<li>При необходимости создайте TV-параметр <i>cart_icon</i> с типом ввода Image, в котором будет задаваться иконка товара, отображаемая в корзине. Присвойте этот параметр шаблону страницы, которая является карточкой товара;</li>

<li>Создайте три документа, где будут <b>Корзина</b>, <b>Оформление покупки</b> и <b>Завершение покупки</b> (сделайте скрытой);</li>
<li>На файлы <b>/assets/snippets/tsvshop/js/config.js</b> и <b>/assets/snippets/tsvshop/include/config.inc.php</b> нужно выставить права на запись.</li>
<li>Для <b>Корзины</b> вызов сниппета такой:<br /> <code>[!TSVshop? &act=`basket` &checkid=``!]</code> – где <i>checkid</i> – ИД страницы оформления покупки;</li>
<li>Для <b>Оформления покупки</b> вызов такой:<br /> <code>[!TSVshop? &act=`checkout` &backid=``!]</code> – где <i>backid</i> – ИД страницы, куда переход после успешной покупки;</li>
<li>Для <b>Завершения покупки</b> такой:<br /> <code>[!TSVshop? &act=`finish`!]</code></li>
  <li>В любом месте шаблона страницы или документа, в котором будет выводиться список товаров, вставьте вызов:<br /><code>[[TSVshop? &act=`none`]]</code> – это касается <b>только</b> той страницы, где ни разу не вызывался сниппет TSVshop. Этот вызов вставит в код страницы служебные скрипты, необходимые для работы корзины. На странице корзины, оформления и завершения покупки, а также там, где есть хотя-бы один вызов сниппета TSVshop, этот вызов не делать;</li>
<li>При желании в любую часть страницы можно вставить инфоблок корзины, в котором отображается общая сумма заказа и колличество товаров в корзине со ссылкой на саму корзину. Вызов инфоблока таков: <br /> <code>[[TSVshop? &act=`info` &basketid=``]]</code> – где <i>baskeid</i> – ИД страницы с корзиной; </li>
<li>Теперь в самом каталоге продукции в Ditto используйте чанк product. Например:<br /><code>[[Ditto? &language=`russian` &tpl=`product` &sortDir=`ASC` &extenders=`shop`]]</code> – это выведет продукцию с кнопкой «В корзину». <span style="color:red">ОБРАТИТЕ ВНИМАНИЕ! В вызове Ditto при выводе списка товаров магазина указан параметр <b>&extenders=`shop`</b> - его присутствие обязательно. С его помощью идет обработка чанка product. Без этого параметра добавление в корзину работать не будет.</span></li>
<li>Если вам нужно вставить кнопку добавления товара в корзину на отдельной странице, без использования Ditto, то воспользуйтесь таким кодом:
<code>
[!TSVshop? &act=`itemcard`!]
&lt;form action="" method="post" name="Tovar[*id*]" id="Tovar[*id*]" &gt;
[+tsvoptions+]
  Цена: [+tsvprice+] руб.
  &lt;p&gt;&lt;input type="text" name="qty" value="1" [+tsvbattr+] /&gt;&lt;/p&gt;
   &lt;a href="javascript: void(0);" onclick="AddToCart('[*id*]');return false"&gt;В корзину&lt;/a&gt;
[+tsvservices+]
&lt;/form&gt;
</code>
  Обратите внимание, что обязательно наличие вызова сниппета [!TSVshop? &act=`itemcard`!], поскольку с его помощью идет обработка плейсхолдеров [+tsvoptions+], [+tsvprice+], [+tsvbattr+] и [+tsvservices+] (это системные плейсхолдеры, вместо которых выводится служебная информация). Также при вызове [!TSVshop? &act=`itemcard`!] срабатывает событие <i>TSVshopOnViewItemCard</i>, которое можно повесить на плагин для обработки карточки товара или для подсчета просмотров товара. 
</li>
</ol>

<h2>Экстендеры для Ditto</h2>
  <p>Как писалось в разделе установки, существует екстендер <i>shop</i>, предназначенный для обработки служебных плейсхолдеров сниппета. Его нужно вызвать при выводе товаров с помощью Ditto, чтобы получилось <i>&extenders=`shop`</i>. Кроме того, начиная с версии 4.8 rc модуля, функции экстендера расширены. (для ранних версий был отдельный экстендер sortprice). Добавлена возможность сортировки товаров по цене или дополнительным параметрам товара. Данный экстендер добавляет к Ditto 2 новых параметра: <b>sortDirPrice</b> и <b>sortByPrice</b>.</p>
<p><b>sortByPrice</b> - поле для сортировки: price (по цене) или param (по доп. параметрам)<br /> <b>sortDirPrice</b> - порядок сортировки: ASC (по возрастанию) или DESC (по убыванию) </p>

<p>Например, нам нужно отсортировать все товары по цене в порядке убывания. Но поскольку цена может быть в виде формулы, напр., <b>1-10==100||90</b>, то Ditto не сможет корректно отсортировать товары по цене. В таком случае делаем вызов:</p> 
<code>[[Ditto? &tpl=`product` &sortDir=`ASC` &extenders=`shop` &sortByPrice=`price` &sortDirPrice=`DESC`]]</code>
<p>и все товары будут отсортированы по цене в порядке убывания</p>

<p>Если же, например, у товаров есть дополнительный параметр Диаметр (с помощью плагина TSVsparam), и у каждого диаметра есть своя цена, а нам нужно отсортировать товары не по основной цене, а по цене диаметра. В таком случае делаем вызов:</p>
<code>[[Ditto? &tpl=`product` &sortDir=`ASC` &extenders=`shop` &sortByPrice=`param` &sortDirPrice=`DESC`]]</code>
<p>и все товары будут отсортированы по цене диаметра в порядке убывания. Причем если у товара один из диаметоров будет активным, будет учитываться именно он, в противном случае учитывается первый по счету диаметр</p>

<h2>Манипуляция ценами</h2>
<p>В данной версии сниппета реализована очень удобная функция манипуляцией ценами. Теперь вы можете в качестве цены указать не только стоимость товара, но и несложную формулу, которая вычисляет стоимость товара в зависимости от количества заказанного товара. </p> 
<p>Рассмотрим это на примере. Представим себе, что стоимость товара зависит напрямую от того, сколько единиц товара заказал клиент. Допустим, если заказать от 1 до 5 единиц товаров, то стоимость будет 100 рублей, если от 6 до 10 единиц, то 90, а если от 11 и более, то 80. Чтобы реализовать такую возможность, достаточно в поле Цена указать: 1-5==100||6-10==90||80. Значение 1 и 2 вариантов понятны, последний - это цена, которая применяется, если не соблюдается ни одно условие. Т.е. более 10 единиц товаров. Можно создавать неограниченное количество условий.</p>
<p>Из вышеприведенного примера видно, что принцип построения формулы довольно простой: <b>ОТ1-ДО1==ЦЕНА1||ОТ2-ДО2==ЦЕНА2||ЦЕНА3</b>. Это означает: Если заказать количество товара в промежутке ОТ1 до ДО1 штук, то цена будет ЦЕНА1, если ОТ2 до ДО2, то цена будет ЦЕНА2, если не соблюдается ни одно условие, то цена будет ЦЕНА3.</p>
<p>Итак, в поле Цена (TV-параметр price) можно указывать либо просто цену, либо формулу с условиями.</p>

<h2>Дополнительные параметры товаров (Сниппет TSVshop_options)</h2>
<p>Вы можете задать для каждого товара дополнительные параметры, например, цвет, размер, объем. При этом каждый из параметров может влиять на общую стоимость товара: приплюсовываться, умножаться или вычитаться. А на странице товара или в списке товаров вы можете вывести эти параметры в виде  выпадающего списка, радиокнопки, чекбокса.</p>
<p>Рассмотрим это на примере. Допустим, у товара "Ветровка" есть 2 дополнительных параметра: цвет (красный и синий) и размер (48, 50, 52). При выборе красного цвета цена увеличивается на 100 рублей, а при синем - становится на 20 рублей дешевле. Ну а при выборе любого из размеров цена никак не меняется. Чтобы это реализовать, существует сниппет <b>TSVshop_options</b>.</p>
<p>Сначала установим и настроим его - смотрите раздел УСТАНОВКА, пунткы 5 и 20. После установки и настройки в документе товара у нас будет еще один ТВ - tsvshop_param. При добавлении или редактирования товара в нем мы задаем параметры товара в таком виде: <br /> <code>Группа1; Группа2; …..;</code></p>
<p>Группы параметров разделяются точкой с запятой, а также точкой с запятой ставится после всех групп. Каждая из групп состоит из независимых виджетов.<br /><code>Тип==Название:Параметр1==Значение1||Параметр2==Значение2||...</code></p>
<p><b>Тип</b> – <i><u>Обязательный параметр</u></i>, может принимать 3 значения:</p>
<ol>
<li><i>radio</i> - Переключатели. Используются, когда следует выбрать один вариант из нескольких предложенных;</li>
<li><i>checkbox</i> - Флажки. Позволяют выбрать более одного варианта из предложенных;</li>
<li><i>select</i> - раскрывающейся список.</li>
</ol>
<p><b>Название</b> - <i><u>Не обязательный параметр</u></i>, название группы параметров. Любой текст. Может быть пустым.</p>
<p><b>Параметр</b> - <i><u>Не обязательный параметр</u></i>,  название группы параметров. Любой текст. Может быть пустым. Если начинается с *, тогда этот пункт будет активным при загрузке страницы.</p>
<p>
<b>Значение</b> - <i><u>Обязательный параметр</u></i>. Показывает как отразится на общей стоимости, если выбран данный пункт. Может иметь следующие значения:
</p>
<ol>
<li><b>n</b> - <i>добавит</i> n к первоначальной стоимости</li>
<li><b>*n</b> - <i>умножит</i>  первоначальной стоимости на n</li>
<li><b>-n</b> - <i>отнимет</i> n от первоначальной стоимости</li>
</ol>
<p>Пример (первое значение пусто):<br /><code>==||Подарочная упаковка==35||Подарочная сумочка==50</code></p>
<p>Можно задать параметры со значением "0". Это полезно для параметров, которые не влияют на цену (например цвет). Пример: <code>синий==0||зеленый==0||красный==0</code></p>
<p>Полный пример: <br /><textarea readonly="readonly" cols="100" rows="5">radio==Цвет:синий==0||зеленый==0||*красный==0;checkbox==Дополнения:Доп.насадки==1||Упаковка==2||Документация==-4;select==Комплектация:минимум==*0.8||*стандарт==0||полный фарш==*1.2;</textarea></p>

<h2>Плагин TSVsparam</h2>
<p>Данный плагин позволяет упростить добавление дополнительных параметров товаров. При его использовании отпадает необходимость вручную писать вышеприведенные формулы в TV tsvshop_param. Весь процесс добавления становится интуитивно понятным. Убедитесь сами:</p>
<p><b>Добавление доп. параметров без плагина:</b><br /><img src="noplugin.jpg"></p>
<p><b>Добавление доп. параметров с плагином:</b><br /><img src="plugin.jpg"></p>
<p>Данный плагин платный, его цена составляет 15 WMZ, опробовать его можно в работе на демосайте <a href="http://tsvshop.tsv.org.ua">http://tsvshop.tsv.org.ua</a>.</p>

<h2>Чанки, шаблоны, плейсхолдеры</h2>
<h3>Чанк product</h3>
<p>Используется совместно со сниппетом Ditto для вывода товаров из каталога. Минимальный код, который треубется для корректной работы чанка и добавления в корзину, следующий:</p>
<code>
&lt;form action="index.php" method="post" name="Tovar[+id+]" id="Tovar[+id+]"&gt;
[+tsvoptions+]
[+tsvprice+] руб.
&lt;a href="javascript: void(0);" onclick="AddToCart('[+id+]');return false"&gt;В корзину&lt;/a&gt;
[+tsvservices+]
&lt;/form&gt;
</code>
<p>Вы можете редактировать чанк как желаете, главное, чтобы в вашем коде сохранились вышеприведенные плейсхолдеры, форма и ссылка на добавление товара в корзину. Их месторасположение в чанке не имеет значение, главное, чтобы они были внутри формы.</p>
<table width="100%">
<tr>
<td colspan="2" class="head">Плейсхолдеры чанка product</td>
</tr>
<tr>
<td>id="Tovar[+id+]"</td><td>наличие в теге form <b>обязательно</b></td>
</tr>

<tr>
<td>[+tsvprice+]</td>
<td>Выводит окончательную стоимость товара на страницу. Выводимая этим плейсхолдером стоимость товара подсчитывается динамически, учитывая дополнительные параметры товара, скидки и т.д. Например, если у товара есть дополнительные параметры: цена, размер и т.д. и которые имеют свою цену, то при выборе определенного цвета окончательная сумма сразу же отображается вместо данного плейсхолдера. Смотрите пример использования в стандартном чанке product</td>
</tr>
<tr>
<td>[+tsvoptions+]</td>
<td>Выводит список дополнительных параметров товара: выпадающий список, checkbox, radiobutton. Смотрите пример использования в стандартном чанке product. Наличие в теге form <b>обязательно</b>, даже если не будут использоваться дополнительные параметры товаров.</td>
</tr>
<tr>
<td>[+cart_icon+]</td>
<td>Выводит ПУТЬ к картинке товара, которая будет отображаться в корзине. Используйте TV-параметр <b>cart_icon</b>. Используется в таком виде: <i>&lt;input type="hidden" name="cart_icon" value="[+cart_icon+]" /&gt;</i>. Важно, что TV cart_icon должнен возвращать ПУТЬ к картинке, а не саму куртинку. <b>Использование в чанке обязательно, даже если вы не планируете использовать картинку товара.</b> Смотрите пример использования в стандартном чанке product</td>
</tr>
<tr>
<td>[+tsvservices+]</td>
<td>Служебный плейсхолдер, который выводит функции, необходимые для формирования окончательной цены товара. <b>Использовать в чанке товара обязательно.</b> Смотрите пример использования в стандартном чанке product</td>
</tr>
<tr>
<td>[+tsvbattr+]</td>
<td>Служебный плейсхолдер, который выводит дополнительные атрибуты для поля количества заказанного товара. Используется так: <i>&lt;input type="text" name="qty" value="1" [+tsvbattr+] /&gt;</i>. В результате выводится: <i>&lt;input type="text" name="qty" value="1" onkeypress="return testKey(event)" onChange="UserCalc('[+id+]')" /&gt;</i>. Если вы собираетесь использовать поле Количество, то этот плейсхолдер <b>использовать обязательно</b>.</td>
</tr>
</table>

<h3>Чанк Shop_Cart</h3>
<p>Предназначен для вывода корзины заказов при вызове [[TSVshop? &act=`basket`]]</p>

<table width="100%">
<tr>
<td colspan="2" class="head">Плейсхолдеры чанка Shop_Cart</td>
</tr>
<tr>
<td width="200">[+shop.basket.iconpath+]</td>
  <td>Путь к маленькому фото товара. Используйте TV-параметр <b>cart_icon</b>. Служит для вставки в тег <b>img</b> в атрибут <i>src</i>. Чтобы картинка стала доступной в корзине, нужно в чанке товара добавить скрытое поле с именем <i>cart_icon</i>, а в качестве значения вставить TV <i>cart_icon</i>. Например, <i>&lt;input type="hidden" name="cart_icon" value="[+cart_icon+]" /&gt;</i>. Пример смотрите в стандартном чанке <i>product</i>. Важно, что TV cart_icon должнен возвращать ПУТЬ к картинке, а не саму куртинку. При отсутствии картинки в TV cart_icon подставляется картинка по-умолчанию: assets/snippets/tsvshop/images/noimage.png </td>
</tr>

<tr>
<td width="200">[+shop.basket.num+]</td>
<td>Порядковый номер товара в корзине.  Можно использовать для
своих нужд, например, пронумеровать товары в корзине или для подстановки в вызовы функций:
onChange="ChangeQuantity('[+shop.basket.num+]', 4);"  (этот вызов отправит ajax-
запрос, изменив кол-во текущего товара в корзине до 4 единиц) и т.д.</td>
</tr>
<tr>
<td width="200">[+shop.basket.id+]</td>
<td>ID товара</td>
</tr>
<tr>
<td width="200">[+shop.basket.articul+]</td>
<td>Артикул товара</td>
</tr>
<tr>
<td>[+shop.basket.name+]</td>
  <td>Наименование товара. Какое поле товара будет использоваться, можно установить параметром сниппета &namesource=``, напр., &namesource=`longtitle`. По умолчанию используется pagetitle</td>
</tr>
<tr>
<td>[+shop.basket.link+]</td>
<td>Адрес к странице с товаром. Используется для создания ссылки на страницу товара.</td>
</tr>
<tr>
<td>[+shop.basket.monetary+]</td>
<td>Используемая валюта, например, <i>руб.</i>, <i>грн</i>. Берется из языкового файла.</td>
</tr>
<tr>
<td>[+shop.basket.qinput+]</td>
<td>Выводит полностью сформированное поле <i>Количество</i>, которое в корзине используется для вывода количества заказанного товара. Это поле будет сформированно автоматически, со всеми нужными атрибутами. На выходе получится приблизительно следующее: <i>&lt;input type="text" size="3" name="q" value="1" onkeypress="return testKey(event)" onchange="ChangeQuantity(1, this.value);" &gt;</i> <b>Внимание! Используйте данный вариант ТОЛЬКО при формировании корзины заказа в режиме basket (<i>&act=`basket`</i>). При формировании корзины оформления покупки - режим checkout (<i>&act=`checkout`</i>) - используйте следующий плейсхолдер [+shop.checkout.quantity+]</b>. Т.е. при оформлении покупки в корзине НЕЛЬЗЯ использовать поля ввода.</td>
</tr>
<tr>
<td>[+shop.basket.quantity+]</td>
<td>Количество заказанного товара.</td>
</tr>
<tr>
<td>[+shop.basket.qatributs+]</td>
<td>Служебные атрибуты, которые вставляются в тэг <i>input</i> поля <i>Количество</i>. Используйте в случае, если вы решили не пользоваться автоматической генерацией поля с помощью [+shop.checkout.qinput+]. Для создания в корзине поля ввода Количества вам достаточно вставить следующее: <i>&lt;input type="text" size="3" [+shop.checkout.qatributs+]&gt;</i>. В результате на выходе будет: <i>&lt;input type="text" size="3" name="q" value="количество" onkeypress="return testKey(event)" onchange="ChangeQuantity(количество, this.value);" &gt;</i>. Т.е. вместо плейсхолдера выведутся все служебные атрибуты, необходимые для работы поля Количества.</td>
</tr>
<tr>
<td>[+shop.basket.price+]</td>
<td>Цена одного экземпляра товара.</td>
</tr>
<tr>
<td>[+shop.basket.summa+]</td>
<td>Общая стоимость одного наименования товара. Результат вычисления Цена * Количество.</td>
</tr>
<tr>
<td>[+shop.basket.delatributs+]</td>
<td>Cлужебные атрибуты, которые служат для создания кнопки удаления товара из корзины. Например: <i>&lt;a href="#" [+shop.checkout.delatributs+]&gt;Удалить&lt;/a&gt;</i> на выходе создаст <i>&lt;a href="#" onclick="RemoveFromCart(1); return false" &gt;Удалить&lt;/a&gt;</i>. Или то же самое с тегом <i>button</i>. Т.е. вместо плейсхолдера будут вставлены служебные атрибуты, необходимые для корректной работы кнопки.</td>
</tr>
<tr>
<td>[+shop.basket.subtotal+]</td>
<td>Сумма подитога. Включает в себя чистую общую сумму всего заказа, без наценок, скидок и стоимости доставки.</td>
</tr>
<tr>
<td>[+shop.basket.discountcard+]</td>
<td>Номер дисконтной карты.</td>
</tr>
<tr>
<td>[+shop.basket.discount+]</td>
<td>Размер скидки.</td>
</tr>
<tr>
<td>[+shop.basket.discountsize+]</td>
<td>Итоговая сумма скидки.</td>
</tr>
<tr>
<td>[+shop.basket.shipping+]</td>
<td>Стоимость доставки.</td>
</tr>
<tr>
<td>[+shop.basket.tax+]</td>
<td>Размер налога.</td>
</tr>
<tr>
<td>[+shop.basket.total+]</td>
<td>Итоговая сумма всего заказа. Учтены все наценки, налоги, доставка и скидка.</td>
</tr>
<tr>
<td>[+shop.checkurl+]</td>
<td>Путь к странице с оформлением покупки. Используется для кнопки ОФОРМИТЬ ЗАКАЗ.</td>
</tr>
<tr>
<td>[+shop.selfurl+]</td>
<td>Путь к текущей странице корзины. Используется для кнопки ПЕРЕСЧИТАТЬ или ОЧИСТИТЬ КОРЗИНУ.</td>
</tr>
<tr>
<td>&lt;!--noempty--&gt; и &lt;!--/noempty--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании строк с заказом, когда в корзине имеется хотя бы один товар. Смотрите пример в стандартном чанке Shop_Cart. <b>Выделять участок шаблона обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--subtotal--&gt; и &lt;!--/subtotal--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании строки с подитогом. Смотрите пример в стандартном чанке Shop_Cart. <b>Выделять участок шаблона обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--discount--&gt; и &lt;!--/discount--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании строки с дисконтом. Смотрите пример в стандартном чанке Shop_Cart. <b>Выделять участок шаблона обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--shipping--&gt; и &lt;!--/shipping--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании строки с доставкой. Смотрите пример в стандартном чанке Shop_Cart. <b>Выделять участок шаблона обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--tax--&gt; и &lt;!--/tax--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании строки с налогом. Смотрите пример в стандартном чанке Shop_Cart. <b>Выделять участок шаблона обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--buttons--&gt; и &lt;!--/buttons--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании кнопок ПЕРЕСЧИТАТЬ, ОФОРМИТЬ ЗАКАЗ и т.д. Смотрите пример в стандартном чанке Shop_Cart. <b>Выделять участок шаблона обязательно!</b> Используйте только при формировании корзины в режиме basket (&act=`basket`)</td>
</tr>

</table>

<br />

<h3>Чанк Shop_Checkout</h3>

<p>Предназначен для вывода корзины оформления заказа и формы заказа при вызове [!TSVshop? &act=`checkout`!]</p>

<table width="100%">
<tr>
<td colspan="2" class="head">Плейсхолдеры чанка Shop_Checkout</td>
</tr>
<tr>
<td width="200">[+shop.basket.iconpath+]</td>
<td>Путь к маленькому фото товара. Используйте TV-параметр <b>cart_icon</b>. Служит для вставки в тег <b>img</b> в атрибут <i>src</i>. Чтобы картинка стала доступной в корзине, нужно в чанке товара добавить скрытое поле с именем <i>cart_icon</i>, а в качестве значения вставить TV <i>cart_icon</i>. Например, <i>&lt;input type="hidden" name="cart_icon" value="[+cart_icon+]" /&gt;</i>. Пример смотрите в стандартном чанке <i>product</i>. Важно, что TV cart_icon должнен возвращать ПУТЬ к картинке, а не саму куртинку. При отсутствии картинки в TV cart_icon подставляется картинка по-умолчанию: assets/snippets/tsvshop/images/noimage.png </td>
</tr>

<tr>
<td width="200">[+shop.basket.num+]</td>
<td>Порядковый номер товара в корзине.  Можно использовать для
своих нужд, например, пронумеровать товары в корзине или для подстановки в вызовы функций:
onChange="ChangeQuantity('[+shop.basket.num+]', 4);"  (этот вызов отправит ajax-
запрос, изменив кол-во текущего товара в корзине до 4 единиц) и т.д.</td>
</tr>
<tr>
<td width="200">[+shop.basket.id+]</td>
<td>ID товара</td>
</tr>
<tr>
<td width="200">[+shop.basket.articul+]</td>
<td>Артикул товара</td>
</tr>
<tr>
<td>[+shop.basket.name+]</td>
<td>Наименование товара. Какое поле товара будет использоваться, можно установить параметром сниппета &namesource=``, напр., &namesource=`longtitle`. По умолчанию используется pagetitle</td>
</tr>
<tr>
<td>[+shop.basket.link+]</td>
<td>Адрес к странице с товаром. Используется для создания ссылки на страницу товара.</td>
</tr>
<tr>
<td>[+shop.basket.monetary+]</td>
<td>Используемая валюта, например, <i>руб.</i>, <i>грн</i>. Берется из языкового файла.</td>
</tr>
<tr>
<td>[+shop.basket.qinput+]</td>
<td>Выводит полностью сформированное поле <i>Количество</i>, которое в корзине используется для вывода количества заказанного товара. Это поле будет сформированно автоматически, со всеми нужными атрибутами. На выходе получится приблизительно следующее: <i>&lt;input type="text" size="3" name="q" value="1" onkeypress="return testKey(event)" onchange="ChangeQuantity(1, this.value);" &gt;</i> <b>Внимание! Используйте данный вариант ТОЛЬКО при формировании корзины заказа в режиме basket (<i>&act=`basket`</i>). При формировании корзины оформления покупки - режим checkout (<i>&act=`checkout`</i>) - используйте следующий плейсхолдер [+shop.basket.quantity+]</b>. Т.е. при оформлении покупки в корзине НЕЛЬЗЯ использовать поля ввода.</td>
</tr>
<tr>
<td>[+shop.basket.quantity+]</td>
<td>Количество заказанного товара.</td>
</tr>
<tr>
<td>[+shop.basket.qatributs+]</td>
<td>Служебные атрибуты, которые вставляются в тэг <i>input</i> поля <i>Количество</i>. Используйте в случае, если вы решили не пользоваться автоматической генерацией поля с помощью [+shop.basket.qinput+]. Для создания в корзине поля ввода Количества вам достаточно вставить следующее: <i>&lt;input type="text" size="3" [+shop.basket.qatributs+]&gt;</i>. В результате на выходе будет: <i>&lt;input type="text" size="3" name="q" value="количество" onkeypress="return testKey(event)" onchange="ChangeQuantity(количество, this.value);" &gt;</i>. Т.е. вместо плейсхолдера выведутся все служебные атрибуты, необходимые для работы поля Количества.</td>
</tr>
<tr>
<td>[+shop.basket.price+]</td>
<td>Цена одного экземпляра товара.</td>
</tr>
<tr>
<td>[+shop.basket.summa+]</td>
<td>Общая стоимость одного наименования товара. Результат вычисления Цена * Количество.</td>
</tr>
<tr>
<td>[+shop.basket.delatributs+]</td>
<td>Cлужебные атрибуты, которые служат для создания кнопки удаления товара из корзины. Например: <i>&lt;a href="#" [+shop.basket.delatributs+]&gt;Удалить&lt;/a&gt;</i> на выходе создаст <i>&lt;a href="#" onclick="RemoveFromCart(1); return false" &gt;Удалить&lt;/a&gt;</i>. Или то же самое с тегом <i>button</i>. Т.е. вместо плейсхолдера будут вставлены служебные атрибуты, необходимые для корректной работы кнопки.</td>
</tr>
<tr>
<td>[+shop.basket.subtotal+]</td>
<td>Сумма подитога. Включает в себя чистую общую сумму всего заказа, без наценок, скидок и стоимости доставки.</td>
</tr>
<tr>
<td>[+shop.basket.discountcard+]</td>
<td>Номер дисконтной карты.</td>
</tr>
<tr>
<td>[+shop.basket.discount+]</td>
<td>Размер скидки.</td>
</tr>
<tr>
<td>[+shop.basket.discountsize+]</td>
<td>Итоговая сумма скидки.</td>
</tr>
<tr>
<td>[+shop.basket.shipping+]</td>
<td>Стоимость доставки.</td>
</tr>
<tr>
<td>[+shop.basket.tax+]</td>
<td>Размер налога.</td>
</tr>
<tr>
<td>[+shop.basket.total+]</td>
<td>Итоговая сумма всего заказа. Учтены все наценки, налоги, доставка и скидка.</td>
</tr>
<tr>
<td>[+shop.basket.userform+]</td>
<td>Вместо данного плейсхолдера выведется полностью сформированная форма заказа покупки с помощью сниппета eForm.</td>
</tr>
<tr>
<td>[+shop.checkurl+]</td>
<td>Путь к странице с оформлением покупки. Используется для кнопки ОФОРМИТЬ ЗАКАЗ.</td>
</tr>
<tr>
<td>[+shop.selfurl+]</td>
<td>Путь к текущей странице корзины. Используется для кнопки ПЕРЕСЧИТАТЬ или ОЧИСТИТЬ КОРЗИНУ.</td>
</tr>
<tr>
<td>&lt;!--noempty--&gt; и &lt;!--/noempty--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании строк с заказом, когда в корзине имеется хотя бы один товар. Смотрите пример в стандартном чанке Shop_Checkout. <b>Выделять участок шаблона обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--subtotal--&gt; и &lt;!--/subtotal--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании строки с подитогом. Смотрите пример в стандартном чанке Shop_Checkout. <b>Выделять участок шаблона обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--discount--&gt; и &lt;!--/discount--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании строки с дисконтом. Смотрите пример в стандартном чанке Shop_Checkout. <b>Выделять участок шаблона обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--shipping--&gt; и &lt;!--/shipping--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании строки с доставкой. Смотрите пример в стандартном чанке Shop_Checkout. <b>Выделять участок шаблона обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--tax--&gt; и &lt;!--/tax--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании строки с налогом. Смотрите пример в стандартном чанке Shop_Checkout. <b>Выделять участок шаблона обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--buttons--&gt; и &lt;!--/buttons--&gt;</td>
<td>Выделяют часть шаблона, который учавствует в формировании кнопок ПЕРЕСЧИТАТЬ, ОФОРМИТЬ ЗАКАЗ и т.д. Смотрите пример в стандартном чанке Shop_Checkout. <b>Выделять участок шаблона обязательно!</b> Используйте только при формировании корзины в режиме basket (&act=`basket`)</td>
</tr>

</table>

<br />
<h3>Чанк Shop_Cart_Empty</h3>
<p>Предназначен для вывода пустой корзины заказов. В этом чанке нету плейсхолдеров, поэтому редактировать его вы можете по своему желанию.</p>


<br />
<h3>Чанк Shop_UserForm</h3>
<p>Предназначен для вывода формы пользователя при оформлении покупки. Полностью сгенерированная форма выводится в чанк Shop_Checkout вместо плейсхолдера [+shop.basket.userform+]. Используется сниппетом eForm. Поэтому в данном чанке вы можете использовать синтаксис eForm как пожелаете. Приводим лишь плейсхолдеры, используемые в работе TSVshop: </p>
<table width="100%">
<tr>
<td colspan="2" class="head">Плейсхолдеры чанка Shop_UserForm</td>
</tr>
<tr>
<td>[+shop.basket.login+]</td>
<td>Логин пользователя, который он ввел при регистрации. Используется, если пользователь уже зарегистрирован и авторизовался. Данные берутся из его профиля. Может пригодится.</td>
</tr>
<tr>
<td>[+shop.basket.userid+]</td>
<td>ID пользователя, под которым он числится в базе пользователей. Используется, если пользователь уже зарегистрирован и авторизовался. Данные берутся из его профиля. Может пригодится.</td>
</tr>
<tr>
<td>[+shop.basket.fullname+]</td>
<td>ФИО пользователя, которое он ввел при регистрации. Используется, если пользователь уже зарегистрирован и авторизовался. Данные берутся из его профиля. Можете использовать в форме оформления покупки, чтобы авторизованный пользователь не вводил одни и те же данные много раз.</td>
</tr>
<tr>
<td>[+shop.basket.email+]</td>
<td>E-mail пользователя, которое он ввел при регистрации. Используется, если пользователь уже зарегистрирован и авторизовался. Данные берутся из его профиля. Можете использовать в форме оформления покупки, чтобы авторизованный пользователь не вводил одни и те же данные много раз.</td>
</tr>
<tr>
<td>[+shop.basket.country+]</td>
<td>Страна пользователя, которую он ввел при регистрации. Используется, если пользователь уже зарегистрирован и авторизовался. Данные берутся из его профиля. Можете использовать в форме оформления покупки, чтобы авторизованный пользователь не вводил одни и те же данные много раз.</td>
</tr>
<tr>
<td>[+shop.basket.state+]</td>
<td>Область/район/штат пользователя, который он ввел при регистрации. Используется, если пользователь уже зарегистрирован и авторизовался. Данные берутся из его профиля. Можете использовать в форме оформления покупки, чтобы авторизованный пользователь не вводил одни и те же данные много раз.</td>
</tr>
<tr>
<td>[+shop.basket.zip+]</td>
<td>Индекс пользователя, который он ввел при регистрации. Используется, если пользователь уже зарегистрирован и авторизовался. Данные берутся из его профиля. Может понадобится.</td>
</tr>
<tr>
<td>[+shop.basket.fax+]</td>
<td>Факс пользователя, который он ввел при регистрации. Используется, если пользователь уже зарегистрирован и авторизовался. Данные берутся из его профиля. Может понадобится.</td>
</tr>
<tr>
<td>[+shop.basket.phone+]</td>
<td>Телефон пользователя, который он ввел при регистрации. Используется, если пользователь уже зарегистрирован и авторизовался. Данные берутся из его профиля. Можете использовать в форме оформления покупки, чтобы авторизованный пользователь не вводил одни и те же данные много раз.</td>
</tr>
<tr>
<td>[+shop.basket.fpayments+]</td>
<td>Полностью сформированное поле с выбором доступных пользователю методов оплаты (Модули оплаты приобретаются отдельно и потом устанавливаются.)</td>
</tr>
<tr>
<td>[+shop.basket.fshipping+]</td>
<td>Полностью сформированное поле с выбором доступных пользователю методов доставки (Модуль доставки приобретаются отдельно и потом устанавливаются.)</td>
</tr>
<tr>
<td>[+shop.basket.fdiscount+]</td>
<td>Полностью сформированное поле с вводом номера дисконтной карты (Модуль дисконтной карты приобретается отдельно и потом устанавливается.)</td>
</tr>
 
</table>
<br />

<h3>Чанк Shop_Infoblock</h3>
<p>Чанк предназначен для вывода инфоблока корзины с помощью вызова [[TSVshop? &act=`info`]]. </p>

<table width="100%">
<tr>
<td colspan="2" class="head">Плейсхолдеры чанка Shop_Infoblock</td>
</tr>
<tr>
<td  width="200">[+shop.info.iconpath+]</td>
<td>Путь к маленькому фото товара. Используйте TV-параметр <b>cart_icon</b>. Служит для вставки в тег <b>img</b> в атрибут <i>src</i>. Чтобы картинка стала доступной в корзине и инфоблоке, нужно в чанке товара добавить скрытое поле с именем <i>cart_icon</i>, а в качестве значения вставить TV <i>cart_icon</i>. Например, <i>&lt;input type="hidden" name="cart_icon" value="[+cart_icon+]" /&gt;</i>. Пример смотрите в стандартном чанке <i>product</i>. Важно, что TV cart_icon должнен возвращать ПУТЬ к картинке, а не саму куртинку. При отсутствии картинки в TV cart_icon подставляется картинка по-умолчанию: assets/snippets/tsvshop/images/noimage.png</td>
</tr>
<tr>
<td width="200">[+shop.info.num+]</td>
<td>Порядковый номер товара в корзине.  Можно использовать для
своих нужд, например, пронумеровать товары в корзине или для подстановки в вызовы функций:
onChange="ChangeQuantity('[+shop.basket.num+]', 4);"  (этот вызов отправит ajax-
запрос, изменив кол-во текущего товара в корзине до 4 единиц) и т.д.</td>
</tr>
<tr>
<td width="200">[+shop.info.articul+]</td>
<td>Артикул товара</td>
</tr>
<tr>
<td>[+shop.info.name+]</td>
<td>Наименование товара. Какое поле товара будет использоваться, можно установить параметром сниппета &namesource=``, напр., &namesource=`longtitle`. По умолчанию используется pagetitle</td>
</tr>
<tr>
<td>[+shop.info.link+]</td>
<td>Адрес к странице с товаром. Используется для создания ссылки на страницу товара.</td>
</tr>
 	<tr>
 	<td width="200">[+shop.basket.id+]</td>
	<td>ID товара</td>
</tr>
<tr>
<td>[+shop.info.quantity+]</td>
<td>Количество заказанного товара.</td>
</tr>
<tr>
<td>[+shop.info.price+]</td>
<td>Цена одного экземпляра товара.</td>
</tr>
<tr>
<td>[+shop.info.summa+]</td>
<td>Общая стоимость одного наименования товара. Результат вычисления Цена * Количество.</td>
</tr>
<tr>
<td>[+shop.info.delatributs+]</td>
<td>Cлужебные атрибуты, которые служат для создания кнопки удаления товара из корзины. Например: <i>&lt;a href="#" [+shop.basket.delatributs+]&gt;Удалить&lt;/a&gt;</i> на выходе создаст <i>&lt;a href="#" onclick="RemoveFromCart(1); return false" &gt;Удалить&lt;/a&gt;</i>. Или то же самое с тегом <i>button</i>. Т.е. вместо плейсхолдера будут вставлены служебные атрибуты, необходимые для корректной работы кнопки.</td>
</tr>
<tr>
<td  width="200">[+shop.info.count+]</td>
<td>Общее количество товаров в корзине</td>
</tr>
<tr>
<td>[+shop.info.stovar+]</td>
<td>Слово, которое ставится рядов с количеством товаров в корзине, например, 1 <i>Товар</i>, 2 <i>Товара</i>, 5 <i>Товаров</i>. Вместо данного плейсхолдера можно вставить свое слово, но все же предпочтительнее использовать именно данный плейсхолдер. Поскольку выводимое вместо него слово склоняется в зависимости от количества товаров в корзине, как указано в приведенном выше примере. </td>
</tr>
<tr>
<td>[+shop.info.ssumma+]</td>
<td>Поясняющая надпись перед суммой заказа. Например, <i>Сумма заказа</i>. Берется из языкового файла. При желании можно заменить своим словом.</td>
</tr>
<tr>
<td>[+shop.info.total+]</td>
<td>Общая сумма заказа.</td>
</tr>
<tr>
<td>[+shop.info.monetary+]</td>
<td>Используемая валюта, например, <i>руб.</i>, <i>грн.</i>. Берется из языкового файла.</td>
</tr>
<tr>
<td>[+shop.info.sempty+]</td>
<td>Фраза, выводимая в случае, когда корзина пуста. Берется из языкового файла.</td>
</tr>
<tr>
<td>[+shop.info.carturl+]</td>
<td>Путь к странице с корзиной. Используется для создания ссылки на корзину.</td>
</tr>
<tr>
<td>&lt;!--table--&gt; и &lt;!--/table--&gt;</td>
<td>Выделают часть шаблона, которая будет использоваться для построения списка добавленных товаров. Пример использования смотрите в стандартном чанке Shop_Infoblock. При отсутствии в чанке таблица с товарами не выводится. <b>Пристутствие в чанке не обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--full--&gt; и &lt;!--/full--&gt;</td>
<td>Выделают часть шаблона, которая будет использоваться для построения инфоблока, когда в корзине есть товары. Пример использования смотрите в стандартном чанке Shop_Infoblock. <b>Пристутствие в чанке обязательно!</b></td>
</tr>
<tr>
<td>&lt;!--empty--&gt; и &lt;!--/empty--&gt;</td>
<td>Выделают часть шаблона, которая будет использоваться для построения инфоблока, если корзина будет ПУСТОЙ. Пример использования смотрите в стандартном чанке Shop_Infoblock. <b>Пристутствие в чанке обязательно!</b></td>
</tr>

</table>

<br />

<h3>Чанк Shop_mail_admin</h3>
<p>Данный чанк предназначен для формирования письма о заказе администратору магазина.</p>

<table width="100%">
<tr>
<td colspan="2" class="head">Плейсхолдеры чанка Shop_mail_admin</td>
</tr>

<tr>
<td  width="200">[+shop.mail.date+]</td>
<td>Дата отправки письма</td>
</tr>
<tr>
<td>[+shop.mail.numorder+]</td>
<td>Номер заказа</td>
</tr>
<tr>
<td>[+shop.mail.fio+]</td>
<td>ФИО заказчика или Полное наименование организации</td>
</tr>
<tr>
<td>[+shop.mail.city+]</td>
<td>Город заказчика</td>
</tr>
<tr>
<td>[+shop.mail.dostavka+]</td>
<td>Тип доставки</td>
</tr>

<tr>
<td>[+shop.mail.discountcard+]</td>
<td>Номер дисконтной карты. Если работа с дисконтными картами отключена, то данный плейсхолдер игнорируется.</td>
</tr>

<tr>
<td>[+shop.mail.discount+]</td>
<td>Размер скидки по указанной дисконтной карте. Если работа с дисконтными картами отключена, то данный плейсхолдер игнорируется.</td>
</tr>

<tr>
<td>[+shop.mail.adress+]</td>
<td>Адрес</td>
</tr>
<tr>
<td>[+shop.mail.region+]</td>
<td>Область, регион</td>
</tr>

<tr>
<td>[+shop.mail.province+]</td>
<td>Район</td>
</tr>
<tr>
<td>[+shop.mail.zip+]</td>
<td>Почтовый индекс</td>
</tr>
 
<tr>
<td>[+shop.mail.phone+]</td>
<td>Телефон</td>
</tr>

<tr>
<td>[+shop.mail.email+]</td>
<td>E-mail</td>
</tr>
<tr>
<td>[+shop.mail.code+]</td>
<td>Код доступа к заказу, если на сайте используется форма проверки заказа без личного кабинета.</td>
</tr>

<tr>
<td>[+shop.mail.tracking+]</td>
<td>Трекинг</td>
</tr>
<tr>
<td>[+shop.mail.comments+]</td>
<td>Комментарии к заказу</td>
</tr>

<tr>
<td>[+shop.mail.articul+]</td>
<td>Артикул товара</td>
</tr>
 	<tr>
 	<td width="200">[+shop.mail.id+]</td>
 	<td>ID товара</td>
</tr>


<tr>
<td width="200">[+shop.mail.num+]</td>
<td>Порядковый номер товара в корзине.  Можно использовать для
своих нужд, например, пронумеровать товары в корзине.</td>
</tr>

<tr>
<td>[+shop.mail.name+]</td>
<td>Наименование товара</td>
</tr>

<tr>
<td>[+shop.mail.quantity+]</td>
<td>Количество одного наименования товара</td>
</tr>

<tr>
<td>[+shop.mail.price+]</td>
<td>Цена одного наименования товара</td>
</tr>

<tr>
<td>[+shop.mail.subtotal+]</td>
<td>Подитог стоимости заказа</td>
</tr>

<tr>
<td>[+shop.mail.shipping+]</td>
<td>Цена доставки</td>
</tr>

<tr>
<td>[+shop.mail.shiptype+]</td>
<td>Тип доставки</td>
</tr>

<tr>
<td>[+shop.mail.nalog+]</td>
<td>Налог</td>
</tr>

<tr>
<td>[+shop.mail.payment+]</td>
<td>Метод оплаты</td>
</tr>

<tr>
<td>[+shop.mail.discountnum+]</td>
<td>Номер дисконтной карты</td>
</tr>
<tr>
<td>[+shop.mail.discount+]</td>
<td>Скидка по данной дисконтной карте</td>
</tr>
<tr>
<td>[+shop.mail.discountsize+]</td>
<td>Итоговая сумма скидки</td>
</tr>
<tr>
<td>[+shop.mail.total+]</td>
<td>Полная стоимость заказа</td>
</tr>

<tr>
<td>&lt;!--table--&gt; и &lt;!--/table--&gt;</td>
<td>Выделают часть шаблона, которая будет использоваться для построения списка заказанных товаров. Пример использования смотрите в стандартном чанке Shop_mail_admin</td>
</tr>
<tr>
<td>[+shop.mail.ключ_поля+]</td>
<td>Значение любого поля формы оформления заказа (чанк Shop_UserForm). Напр., значение поля c name="myfield" вставится вместо плейсхолдера [+shop.mail.myfield+] и т.д.</td>
</tr>
</table>

<br />

<h3>Чанк Shop_mail_klient</h3>
<p>Данный чанк предназначен для формирования письма о заказе клиенту.</p>
<table width="100%">
<tr>
<td colspan="2" class="head">Плейсхолдеры чанка Shop_mail_klient</td>
</tr>
<tr>
<td  width="200">[+shop.mail.date+]</td>
<td>Дата отправки письма</td>
</tr>
<tr>
<td>[+shop.mail.numorder+]</td>
<td>Номер заказа</td>
</tr>
<tr>
<td>[+shop.mail.fio+]</td>
<td>ФИО заказчика или Полное наименование организации</td>
</tr>
<tr>
<td>[+shop.mail.city+]</td>
<td>Город заказчика</td>
</tr>
<tr>
<td>[+shop.mail.dostavka+]</td>
<td>Тип доставки</td>
</tr>

<tr>
<td>[+shop.mail.discountcard+]</td>
<td>Номер дисконтной карты. Если работа с дисконтными картами отключена, то данный плейсхолдер игнорируется.</td>
</tr>

<tr>
<td>[+shop.mail.discount+]</td>
<td>Размер скидки по указанной дисконтной карте. Если работа с дисконтными картами отключена, то данный плейсхолдер игнорируется.</td>
</tr>

<tr>
<td>[+shop.mail.adress+]</td>
<td>Адрес</td>
</tr>
<tr>
<td>[+shop.mail.region+]</td>
<td>Область, регион</td>
</tr>

<tr>
<td>[+shop.mail.province+]</td>
<td>Район</td>
</tr>
<tr>
<td>[+shop.mail.zip+]</td>
<td>Почтовый индекс</td>
</tr>
 
<tr>
<td>[+shop.mail.phone+]</td>
<td>Телефон</td>
</tr>

<tr>
<td>[+shop.mail.email+]</td>
<td>E-mail</td>
</tr>
<tr>
<td>[+shop.mail.code+]</td>
<td>Код доступа к заказу, если на сайте используется форма проверки заказа без личного кабинета.</td>
</tr>

<tr>
<td>[+shop.mail.tracking+]</td>
<td>Трекинг</td>
</tr>
<tr>
<td>[+shop.mail.comments+]</td>
<td>Комментарии к заказу</td>
</tr>

<tr>
<td>[+shop.mail.articul+]</td>
<td>Артикул товара</td>
</tr>

<tr>
<td width="200">[+shop.mail.num+]</td>
<td>Порядковый номер товара в корзине.  Можно использовать для
своих нужд, например, пронумеровать товары в корзине.</td>
</tr>

<tr>
<td>[+shop.mail.name+]</td>
<td>Наименование товара</td>
</tr>
 	<tr>
 	<td width="200">[+shop.mail.id+]</td>
 	<td>ID товара</td>
</tr>
<tr>
<td>[+shop.mail.quantity+]</td>
<td>Количество одного наименования товара</td>
</tr>

<tr>
<td>[+shop.mail.price+]</td>
<td>Цена одного наименования товара</td>
</tr>

<tr>
<td>[+shop.mail.subtotal+]</td>
<td>Подитог стоимости заказа</td>
</tr>

<tr>
<td>[+shop.mail.shipping+]</td>
<td>Цена доставки</td>
</tr>

<tr>
<td>[+shop.mail.shiptype+]</td>
<td>Тип доставки</td>
</tr>

<tr>
<td>[+shop.mail.nalog+]</td>
<td>Налог</td>
</tr>

<tr>
<td>[+shop.mail.payment+]</td>
<td>Метод оплаты</td>
</tr>

<tr>
<td>[+shop.mail.discountnum+]</td>
<td>Номер дисконтной карты</td>
</tr>
<tr>
<td>[+shop.mail.discount+]</td>
<td>Скидка по данной дисконтной карте</td>
</tr>
<tr>
<td>[+shop.mail.discountsize+]</td>
<td>Итоговая сумма скидки</td>
</tr>
<tr>
<td>[+shop.mail.total+]</td>
<td>Полная стоимость заказа</td>
</tr>

<tr>
<td>&lt;!--table--&gt; и &lt;!--/table--&gt;</td>
<td>Выделают часть шаблона, которая будет использоваться для построения списка заказанных товаров. Пример использования смотрите в стандартном чанке Shop_mail_klient</td>
</tr>
<tr>
<td>[+shop.mail.ключ_поля+]</td>
<td>Значение любого поля формы оформления заказа (чанк Shop_UserForm). Напр., значение поля c name="myfield" вставится вместо плейсхолдера [+shop.mail.myfield+] и т.д.</td>
</tr>
</table>

<br />

<h3>Чанк Shop_UpdateOrder</h3>
<p>Данный чанк предназначен для формирования письма о заказе клиенту.</p>
<table width="100%">
<tr>
<td colspan="2" class="head">Плейсхолдеры чанка Shop_UpdateOrder</td>
</tr>
<tr>
<td  width="200">[+shop.order.date+]</td>
<td>Дата отправки письма</td>
</tr>
<tr>
<td>[+shop.order.numorder+]</td>
<td>Номер заказа</td>
</tr>
<tr>
<td>[+shop.order.fio+]</td>
<td>ФИО заказчика или Полное наименование организации</td>
</tr>
<tr>
<td>[+shop.order.city+]</td>
<td>Город заказчика</td>
</tr>
<tr>
<td>[+shop.order.dostavka+]</td>
<td>Тип доставки</td>
</tr>

<tr>
<td>[+shop.order.discountcard+]</td>
<td>Номер дисконтной карты. Если работа с дисконтными картами отключена, то данный плейсхолдер игнорируется.</td>
</tr>

<tr>
<td>[+shop.order.discount+]</td>
<td>Размер скидки по указанной дисконтной карте. Если работа с дисконтными картами отключена, то данный плейсхолдер игнорируется.</td>
</tr>

<tr>
<td>[+shop.order.adress+]</td>
<td>Адрес</td>
</tr>
<tr>
<td>[+shop.order.region+]</td>
<td>Область, регион</td>
</tr>

<tr>
<td>[+shop.order.province+]</td>
<td>Район</td>
</tr>
<tr>
<td>[+shop.order.zip+]</td>
<td>Почтовый индекс</td>
</tr>
 
<tr>
<td>[+shop.order.phone+]</td>
<td>Телефон</td>
</tr>

<tr>
<td>[+shop.order.email+]</td>
<td>E-mail</td>
</tr>
<tr>
<td>[+shop.order.code+]</td>
<td>Код доступа к заказу, если на сайте используется форма проверки заказа без личного кабинета.</td>
</tr>

<tr>
<td>[+shop.order.tracking+]</td>
<td>Трекинг</td>
</tr>
<tr>
<td>[+shop.order.comments+]</td>
<td>Комментарии к заказу</td>
</tr>
<tr>
<td>[+shop.order.status+]</td>
<td>Новый статус заказа</td>
</tr>
<tr>
<td>[+shop.order.sitename+]</td>
<td>Название вашего сайта или интернет-магазина. Удобно использовать в подписи письма.</td>
</tr>
<tr>
<td>[+shop.order.articul+]</td>
<td>Артикул товара</td>
</tr>

<tr>
<td>[+shop.order.name+]</td>
<td>Наименование товара</td>
</tr>

<tr>
<td width="200">[+shop.order.num+]</td>
<td>Порядковый номер товара в корзине.  Можно использовать для
своих нужд, например, пронумеровать товары в корзине.</td>
</tr>

<tr>
<td>[+shop.order.quantity+]</td>
<td>Количество одного наименования товара</td>
</tr>

<tr>
<td>[+shop.order.price+]</td>
<td>Цена одного наименования товара</td>
</tr>

<tr>
<td>[+shop.order.subtotal+]</td>
<td>Подитог стоимости заказа</td>
</tr>

<tr>
<td>[+shop.order.shipping+]</td>
<td>Цена доставки</td>
</tr>

<tr>
<td>[+shop.order.shiptype+]</td>
<td>Тип доставки</td>
</tr>

<tr>
<td>[+shop.order.nalog+]</td>
<td>Налог</td>
</tr>

<tr>
<td>[+shop.order.payment+]</td>
<td>Метод оплаты</td>
</tr>

<tr>
<td>[+shop.order.discountnum+]</td>
<td>Номер дисконтной карты</td>
</tr>
<tr>
<td>[+shop.order.discount+]</td>
<td>Скидка по данной дисконтной карте</td>
</tr>
<tr>
<td>[+shop.order.discountsize+]</td>
<td>Итоговая сумма скидки</td>
</tr>
<tr>
<td>[+shop.order.total+]</td>
<td>Полная стоимость заказа</td>
</tr>
</table>

<br />

<h2>Структура и Редактирование чанков</h2>
<p>Внешний вид корзины изменяется в соответствующих чанках и файле <b>shop.css</b>, расположенном в папке со сниппетом. В чанке <i>product</i> используется форма и определенные поля формы. Вы можете редактировать чанк как угодно, главное, чтобы присутсвовали следующие элементы <br /> 
<code>
&lt;form action="index.php" method="post" name="Tovar[+id+]" id="Tovar[+id+]"&gt;
[+tsvoptions+]
[+tsvprice+] руб.
&lt;a href="javascript: void(0);" onclick="AddToCart('[+id+]');return false"&gt;В корзину&lt;/a&gt;
[+tsvservices+]
&lt;/form&gt;
</code>
<p>С помощью конструкции</p>
<code>&lt;a href="javascript: void(0);" onclick="AddToCart('[+id+]');return false"&gt;В корзину&lt;/a&gt;</code>
<p>происходит добавление товаров в корзину (Вместо ссылки можно использовать тег button или другой подходящий).</p>

<p>Для вставки поля количества добавляемых товаров добавьте в чанк ВНУТРЬ формы следующее:</p>
<code>&lt;input type="text" name="qty" size="5" [+tsvbattr+] /&gt;</code> 
<p>Наличие этого поля необязательно. Но если все же собираетесь ее оставить в чанке, то все параметры и плейсхолдер [+tsvbattr+] обязательные, кроме длины поля (size). Его можете менять как угодно.</p>

 <BLOCKQUOTE><h4>Описание функции AddToCart в шаблоне:</h4>

Вызов функции: AddToCart(ID_NUM)<br /><br />

<i>ID_NUM</i> – ID Товара (Это ИД документа или товара из каталога TSVcatalog);
 </p>
</BLOCKQUOTE>



<h2>Заключение</h2>
<p>Мы предоставляем услуги по разработке сайтов и интернет-магазинов на базе MODx, сниппетов, модулей, плагинов. А также готовы по вашему желанию доработать любой функционал для данного модуля TSVshop. Наши контакты на сайте <a href="http://tsv.org.ua">http://tsv.org.ua</a></p>

<p>Если вы хотети поспособствовать дальнейшему развитию данного модуля, вы можете добровольно переслать некоторую сумму на следующие кошельки:</p>
<p><b>Webmomey</b></p>
<ul>
<li>Z395259691722</li>
<li>U203169265788</li>
<li>R143817670638</li>
</ul>
<p><b>Яндекс.Деньги</b></p>
<ul>
<li>41001284536029</li>
</ul>

<p>Желаем вам успехов в ваших начинаниях. С уважением, команда <a href="http://tsv.org.ua">TSVstudio</a></p>
</body>
</html>





